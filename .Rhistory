# Using all covariates gives good estimates for drl. Only one column gives bad for all
library(ggplot2)
library(reshape2)
library(plyr)
library(ggpubr)
library(gridExtra)
library(Jmisc)
load("C:/Users/manja/OneDrive/Documents/codes_Rdata_from_conditional_crc_folder_codes/data_K2_l1_n20000_omega_mse_alpha025.Rdata")
g1 <- ggplot(resultmse[resultmse$variable == "mse",], aes(x = theta0, y = n0/l*value, color = method)) +
geom_line() +
geom_point() +
ylab("n0*MSE") +
xlab(bquote(psi~" (expected number of observations)")) +
scale_x_continuous(breaks = seq(0,1, by = 0.1), labels = paste0(seq(0, 1, by = 0.1), ' (', n0*seq(0, 1, by = 0.1), ')')) +
theme(legend.position = "bottom") +
#facet_wrap(~variable) +
scale_color_manual(values = c("plugin" = "red", "drl" = "goldenrod", "drl.or" = "grey"))
g1
g1 + scale_y_log10()
pdf(paste0("C:/Users/manja/Dropbox/conditional_capture_recapture/codes/images/crc_simulated_barplots/lineplot_K2_l1_n", n0, "_omega_mse_alpha0", round(alpha*100,0), ".pdf"), width = 9, height = 4.5, onefile = FALSE) #height = 375 and 415
g1 + scale_y_log10()
dev.off()
pdf(paste0("C:/Users/manja/Dropbox/conditional_capture_recapture/codes/images/crc_simulated_barplots/lineplot_K2_l1_n", n0, "_omega_mse_alpha0", round(alpha*100,0), ".pdf"), width = 9, height = 4.5, onefile = FALSE) #height = 375 and 415
g1 + scale_y_log10()
dev.off()
g1 <- ggplot(resultmse[resultmse$variable == "mse",], aes(x = theta0, y = n0/l*value, color = method)) +
geom_line() +
geom_point() +
ylab("n0*MSE") +
xlab(bquote(psi~" (expected number of observations)")) +
scale_x_continuous(breaks = seq(0,1, by = 0.1), labels = paste0(seq(0, 1, by = 0.1), ' (', n0*seq(0, 1, by = 0.1), ')')) +
theme(legend.position = "bottom") +
#facet_wrap(~variable) +
scale_color_manual(values = c("plugin" = "red", "drl" = "goldenrod", "drl.or" = "grey"))
g1 + scale_y_log10()
g2 <- ggplot(result[abs(result$theta0 - 0.84) < 0.05,], aes(x = x1, y = value, color = method)) +
geom_point(size = 0.3) +
facet_wrap(~theta0) +
labs(title = substitute(paste("MSE as a function of n for ", alpha, " = ", alp, sep = ''), list(alp = alpha))) +
theme(legend.position = "bottom") +
#facet_wrap(~variable) +
geom_smooth(aes(x = x1, y = plugin.or), method = "glm", color = "black") +
scale_color_manual(values = c("plugin" = "red", "drl" = "goldenrod", "drl.or" = "grey"))
g2
g1 <- ggplot(resultmse[resultmse$variable == "mse",], aes(x = theta0, y = n0/l*value, color = method)) +
geom_line() +
geom_point() +
ylab("n0*MSE") +
xlab(bquote(psi~" (expected number of observations)")) +
labs(title = substitute(paste("MSE as a function of n for ", alpha, " = ", alp, sep = ''), list(alp = alpha))) +
scale_x_continuous(breaks = seq(0,1, by = 0.1), labels = paste0(seq(0, 1, by = 0.1), ' (', n0*seq(0, 1, by = 0.1), ')')) +
theme(legend.position = "bottom") +
#facet_wrap(~variable) +
scale_color_manual(values = c("plugin" = "red", "drl" = "goldenrod", "drl.or" = "grey"))
pdf(paste0("C:/Users/manja/Dropbox/conditional_capture_recapture/codes/images/crc_simulated_barplots/lineplot_K2_l1_n", n0, "_omega_mse_alpha0", round(alpha*100,0), ".pdf"), width = 9, height = 4.5, onefile = FALSE) #height = 375 and 415
g1 + scale_y_log10()
dev.off()
g1 <- ggplot(resultmse[resultmse$variable == "mse",], aes(x = theta0, y = n0/l*value, color = method)) +
geom_line() +
geom_point() +
ylab("n0*MSE") +
xlab(bquote(psi~" (expected number of observations)")) +
labs(title = substitute(paste("MSE as a function of", psi, " for ", alpha, " = ", alp, " and n = ", n0, sep = ''), list(alp = alpha))) +
scale_x_continuous(breaks = seq(0,1, by = 0.1), labels = paste0(seq(0, 1, by = 0.1), ' (', n0*seq(0, 1, by = 0.1), ')')) +
theme(legend.position = "bottom") +
#facet_wrap(~variable) +
scale_color_manual(values = c("plugin" = "red", "drl" = "goldenrod", "drl.or" = "grey"))
pdf(paste0("C:/Users/manja/Dropbox/conditional_capture_recapture/codes/images/crc_simulated_barplots/lineplot_K2_l1_n", n0, "_omega_mse_alpha0", round(alpha*100,0), ".pdf"), width = 9, height = 4.5, onefile = FALSE) #height = 375 and 415
g1 + scale_y_log10()
dev.off()
n0
g1 <- ggplot(resultmse[resultmse$variable == "mse",], aes(x = theta0, y = n0/l*value, color = method)) +
geom_line() +
geom_point() +
ylab("n0*MSE") +
xlab(bquote(psi~" (expected number of observations)")) +
labs(title = substitute(paste("MSE as a function of ", psi, " for ", alpha, " = ", alp, " and n = ", n0, sep = ''), list(alp = alpha, n0 = n0))) +
scale_x_continuous(breaks = seq(0,1, by = 0.1), labels = paste0(seq(0, 1, by = 0.1), ' (', n0*seq(0, 1, by = 0.1), ')')) +
theme(legend.position = "bottom") +
#facet_wrap(~variable) +
scale_color_manual(values = c("plugin" = "red", "drl" = "goldenrod", "drl.or" = "grey"))
g1
pdf(paste0("C:/Users/manja/Dropbox/conditional_capture_recapture/codes/images/crc_simulated_barplots/lineplot_K2_l1_n", n0, "_omega_mse_alpha0", round(alpha*100,0), ".pdf"), width = 9, height = 4.5, onefile = FALSE) #height = 375 and 415
g1 + scale_y_log10()
dev.off()
g1 <- ggplot(resultmse[resultmse$variable == "mse",], aes(x = theta0, y = n0/l*value, color = method)) +
geom_line() +
geom_point() +
ylab("n0*MSE") +
xlab(bquote(psi~" (expected number of observations)")) +
labs(title = substitute(paste("MSE as a function of ", psi, " for ", alpha, " = ", alp, " and n = ", n0, sep = ''), list(alp = alpha, n0 = n0))) +
scale_x_continuous(breaks = seq(0,1, by = 0.1), labels = paste0(seq(0, 1, by = 0.1), ' (', n0*seq(0, 1, by = 0.1), ')')) +
theme(legend.position = "bottom", text = element_text(size = 12)) +
#facet_wrap(~variable) +
scale_color_manual(values = c("plugin" = "red", "drl" = "goldenrod", "drl.or" = "grey"))
pdf(paste0("C:/Users/manja/Dropbox/conditional_capture_recapture/codes/images/crc_simulated_barplots/lineplot_K2_l1_n", n0, "_omega_mse_alpha0", round(alpha*100,0), ".pdf"), width = 9, height = 4.5, onefile = FALSE) #height = 375 and 415
g1 + scale_y_log10()
dev.off()
